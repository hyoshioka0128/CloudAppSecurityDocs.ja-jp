---
title: Microsoft Cloud App Security アプリの条件付きアクセス制御で保護する
description: この記事では、Cloud App Security アプリの条件付きアクセス制御リバースプロキシのしくみに関する情報を提供します。
keywords: ''
author: shsagir
ms.author: shsagir
manager: shsagir
ms.date: 01/15/2020
ms.topic: conceptual
ms.collection: M365-security-compliance
ms.prod: ''
ms.service: cloud-app-security
ms.technology: ''
ms.reviewer: reutam
ms.suite: ems
ms.custom: seodec18
ms.openlocfilehash: 8087effca6ceee2c65a9660391ac5606d8ef05e6
ms.sourcegitcommit: 3f6ef6b97a0953470135d115323a00cf11441ab7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/08/2020
ms.locfileid: "78927802"
---
# <a name="protect-apps-with-microsoft-cloud-app-security-conditional-access-app-control"></a>Microsoft Cloud App Security アプリの条件付きアクセス制御を使用したアプリの保護

*適用対象: Microsoft Cloud App Security*

今日の職場では、多くの場合、クラウド環境で何が起こっているかを実際に把握するのに十分ではありません。 従業員が意図的または不注意にデータと組織を危険にさらす前に、侵害とリークをリアルタイムで停止したい。 組織内のユーザーがクラウドアプリで最も多くのサービスとツールを使用できるようにし、自分のデバイスが動作するようにすることが重要です。 同時に、データの漏洩やデータの盗難から、リアルタイムで組織を保護するためのツールが必要です。 Azure Active Directory (Azure AD) と共に、Microsoft Cloud App Security はアプリの条件付きアクセス制御を使用して包括的で統合されたエクスペリエンスでこれらの機能を提供します。

> [!NOTE]
>
> - Cloud App Security アプリの条件付きアクセス制御を使用するには、 [Azure Active Directory P1 ライセンス](https://azure.microsoft.com/pricing/details/active-directory/)、およびアクティブな Microsoft Cloud App Security サブスクリプションまたは Office 365 E5 ライセンスが必要です。 Office 365 E5 に含まれるおすすめアプリの一覧については、「 [office 365 のおすすめアプリ](#O365-apps)」を参照してください。
> - アクセスとセッション制御では、Azure AD 以外の id プロバイダーで構成されたアプリもサポートされます。 このシナリオの詳細については、mcaspreview@microsoft.comに電子メールを送信してください。

## <a name="how-it-works"></a>しくみ

アプリの条件付きアクセス制御はリバースプロキシアーキテクチャを使用し、Azure AD 条件付きアクセスと一意に統合されます。 条件付きアクセスを Azure AD と、特定の条件に基づいて組織のアプリにアクセス制御を適用できます。 条件では、ユーザーまたはユーザーのグループと、条件付きアクセスポリシーが適用される*場所*(クラウドアプリ *) と、* その場所 (どの場所とネットワーク)*が定義さ*れます。 条件を決定した後、アクセスとセッション制御を適用することにより、ユーザーをアプリの条件付きアクセス制御で保護できる Microsoft Cloud App Security にユーザーをルーティングできます。

アプリの条件付きアクセス制御を使用すると、アクセスポリシーとセッションポリシーに基づいて、ユーザーアプリのアクセスとセッションをリアルタイムで監視および制御できるようになります。 アクセスポリシーとセッションポリシーは Cloud App Security ポータル内で使用され、フィルターをさらに調整し、ユーザーに対して実行されるアクションを設定します。 アクセスポリシーとセッションポリシーを使用すると、次のことができます。

- **データを禁止**する: 管理されていないデバイスなど、機密性の高いドキュメントのダウンロード、切り取り、コピー、および印刷をブロックできます。

- **ダウンロード時の保護**: 機密性の高いドキュメントのダウンロードをブロックするのではなく、ドキュメントにラベルを付けて Azure Information Protection で保護するように要求できます。 この操作により、ドキュメントが保護され、ユーザーアクセスが危険な可能性のあるセッションで制限されます。

- ラベルが付けられてい**ないファイルのアップロードを禁止**する: 機密性の高いファイルがアップロード、配布、および使用される前に、ファイルに適切なラベルと保護が設定されていることを確認することが重要です。 機密コンテンツが含まれているラベルのないファイルが、ユーザーがコンテンツを分類するまでアップロードされないようにすることができます。

- **コンプライアンス対応のためにユーザーセッションを監視**する: 危険なユーザーがアプリにサインインすると、そのアクションがセッション内からログに記録されます。 ユーザーの行動を調査して分析し、どこで、どのような条件でセッションポリシーを適用するかを理解することができます。

- **アクセスをブロック**する: いくつかのリスク要因に応じて、特定のアプリとユーザーのアクセスを細かくブロックできます。 たとえば、デバイス管理の形式としてクライアント証明書を使用している場合は、ブロックできます。

- **カスタムアクティビティをブロック**する: アプリによっては、Microsoft Teams や Slack などのアプリで機密性の高いコンテンツを含むメッセージを送信するなど、リスクを伴う固有のシナリオがあります。 このようなシナリオでは、機密性の高いコンテンツのメッセージをスキャンし、リアルタイムでブロックできます。

### <a name="how-session-control-works"></a>セッション制御のしくみ

アプリの条件付きアクセス制御でセッションポリシーを作成すると、アプリに直接ではなくリバースプロキシ経由でユーザーをリダイレクトすることで、ユーザーセッションを制御できます。 その後、ユーザーの要求と応答は、アプリに直接ではなく Cloud App Security 経由で実行されます。

セッションがプロキシによって保護されている場合、関連するすべての Url と cookie が Cloud App Security に置き換えられます。 たとえば、アプリが `myapp.com`で終わるドメインのリンクを含むページを返す場合、リンクのドメインには、次のように `*.cas.ms`のようなサフィックスが付けられます。

|アプリの URL|置換された URL|
|---|---|
|`myapp.com`|`myapp.com.us.cas.ms`|

この方法では、デバイスに何もインストールする必要はありません。管理されていないデバイスやパートナーユーザーからのセッションを監視または制御する場合に最適です。

> [!NOTE]
> Cloud App Security では、世界中の Azure データ センターが活用され、位置情報によって最適化されたパフォーマンスが提供されます。 つまり、トラフィック パターンとその場所によっては、ユーザーのセッションが特定のリージョンの外部でホストされる可能性があります。 ただし、お客様のプライバシーを保護するために、これらのデータ センターにセッション データが保存されることはありません。

## <a name="managed-device-identification"></a>管理対象デバイスの識別

アプリの条件付きアクセス制御を使用すると、デバイスが管理されているかどうかを考慮するポリシーを作成できます。 デバイスの状態を識別するために、アクセスポリシーとセッションポリシーを構成して次のことを確認できます。

- Microsoft Intune (Intune) 準拠デバイス
- Hybrid Azure AD 参加済みデバイス
- 信頼されたチェーンにクライアント証明書が存在する

### <a name="intune-compliant-and-hybrid-azure-ad-joined-devices"></a>Intune に準拠しているデバイスとハイブリッド Azure AD 参加済みデバイス

条件付きアクセスを Azure AD と、準拠デバイスとハイブリッド参加デバイスの情報を Microsoft Cloud App Security に直接渡すことができます。 そこから、デバイスの状態をフィルターとして使用するアクセスポリシーまたはセッションポリシーを開発できます。 詳細については、「 [Azure Active Directory でのデバイス管理の概要](https://docs.microsoft.com/azure/active-directory/device-management-introduction)」を参照してください。

> [!NOTE]
> 一部のブラウザーでは、拡張機能のインストールなどの追加の構成が必要になる場合があります。 詳細については、「[条件付きアクセスブラウザーのサポート](https://go.microsoft.com/fwlink/?linkid=2102732)」を参照してください。

### <a name="client-certificate-authenticated-devices"></a>クライアント証明書で認証されたデバイス

デバイス識別メカニズムは、クライアント証明書を使用して関連するデバイスに認証を要求できます。 組織に既に展開されている既存のクライアント証明書を使用するか、管理対象デバイスに新しいクライアント証明書を展開することができます。 その後、これらの証明書の存在を使用して、アクセスポリシーとセッションポリシーを設定します。

SSL クライアント証明書は、信頼チェーンによって検証されます。 PEM 証明書形式でフォーマットされた x.509 ルートまたは中間証明機関 (CA) をアップロードできます。 これらの証明書には、CA の公開キーが含まれている必要があります。これは、セッション中に提示されたクライアント証明書の署名に使用されます。

証明書がアップロードされ、関連するポリシーが構成されている場合、該当するセッションがアプリの条件付きアクセス制御になると、Cloud App Security エンドポイントはブラウザーに SSL クライアント証明書を提示するように要求します。 ブラウザーは、秘密キーと共にインストールされる SSL クライアント証明書を提供します。 この証明書と秘密キーの組み合わせは、PKCS #12 ファイル形式 (通常は p12 または .pfx) を使用して行われます。

クライアント証明書の確認を実行すると、Cloud App Security によって次の条件が確認されます。

1. 選択されたクライアント証明書は有効で、正しいルート CA または中間 CA の下にあります。
1. 証明書は失効していません (CRL が有効になっている場合)。

> [!NOTE]
> ほとんどの主要なブラウザーは、クライアント証明書の確認をサポートしています。 ただし、モバイルアプリとデスクトップアプリは、多くの場合、このチェックをサポートしていないため、これらのアプリの認証に影響を与える組み込みのブラウザーを活用します。

クライアント証明書を使用してデバイス管理を活用するようにポリシーを構成するには:

1. Cloud App Security のメニューバーで、[設定] 歯車![設定アイコン](media/settings-icon.png "設定アイコン")をクリックし、 **[設定]** を選択します。

1. **[デバイス id]** タブを選択します。
1. 必要な数のルートまたは中間証明書をアップロードします。

証明書がアップロードされたら、**デバイスタグ**と**有効なクライアント証明書**に基づいて、アクセスとセッションポリシーを作成できます。

## <a name="supported-apps-and-clients"></a>サポートされているアプリとクライアント

セッションとアクセスの制御は、SAML 2.0 または Open ID Connect 認証プロトコルを使用して、任意の対話型シングルサインオンに適用できます。 これらのコントロールは、 [Azure AD アプリプロキシ](https://docs.microsoft.com/azure/active-directory/manage-apps/application-proxy)で構成されたオンプレミスでホストされているアプリに適用することもできます。 また、アクセス制御は、ネイティブのモバイルおよびデスクトップクライアントアプリに適用することもできます。

Cloud App Security は、クラウドアプリカタログで利用可能な情報を使用してアプリを識別します。 一部の組織とユーザーは、プラグインを追加してアプリをカスタマイズします。 ただし、セッションコントロールがこれらのプラグインで正しく機能するためには、関連付けられているカスタムドメインを、カタログ内の各アプリに追加する必要があります。

> [!NOTE]
> 他のネイティブクライアントアプリのサインインフローでは、認証アプリは非対話型のサインインフローを使用し、アクセス制御では使用できません。

### <a name="access-controls"></a>アクセス制御

クラウドアプリのセッション制御を使用してセッション内アクティビティを制御する多くの組織では、アクセス制御を適用して、ネイティブモバイルアプリとデスクトップクライアントアプリの同じセットをブロックすることで、アプリに包括的なセキュリティを提供します。

**クライアントアプリ**フィルターを**モバイルおよびデスクトップ**に設定することにより、アクセスポリシーを使用してネイティブのモバイルおよびデスクトップクライアントアプリへのアクセスをブロックできます。 一部のネイティブクライアントアプリは個別に認識できますが、アプリスイートの一部である他のアプリは、最上位レベルのアプリとしてのみ識別できます。 たとえば、SharePoint Online などのアプリは、Office 365 アプリに適用されたアクセスポリシーを作成することによってのみ認識できます。

> [!NOTE]
> **クライアントアプリ**のフィルターが特に **[モバイルとデスクトップ**] に設定されていない限り、結果のアクセスポリシーはブラウザーセッションにのみ適用されます。 この理由は、誤ってユーザーセッションをプロキシしないようにするためです。これは、このフィルターを使用することの副産物です。 多くの主要なブラウザーでクライアント証明書の確認を実行できますが、一部のモバイルアプリおよびデスクトップアプリでは、このチェックをサポートしていない組み込みのブラウザーが使用されています。 このため、このフィルターを使用すると、これらのアプリの認証に影響を与える可能性があります。

### <a name="session-controls"></a>セッションコントロール

セッション制御は、任意のオペレーティングシステム上の任意の主要なプラットフォーム上の任意のブラウザーで動作するように構築されていますが、Microsoft Edge (最新)、Google Chrome (最新)、Mozilla Firefox (最新)、または Apple Safari (最新) をサポートしています。 モバイルアプリとデスクトップアプリへのアクセスをブロックまたは許可することもできます。

> [!NOTE]
> Cloud App Security では、クラス最高レベルの暗号化を提供するために、トランスポート層セキュリティ (TLS) プロトコル 1.2 以降が活用されます。 TLS 1.2 以降をサポートしていないネイティブクライアントアプリとブラウザーは、セッション制御を使用して構成した場合にアクセスできません。 ただし、TLS 1.1 以下を使用している SaaS アプリは、Cloud App Security を使用して構成されている場合、TLS 1.2 以降を使用しているようにブラウザーに表示されます。

<a name="featured-apps"></a>SAML または Open ID Connect を使用して構成されているすべてのアプリを Azure AD とネイティブに統合することにより、自分で任意のアプリをオンボードできます。 さらに、次のアプリは Cloud App Security によって機能しており、既にオンボードで、任意のテナントで使用する準備ができています。

- AWS
- Azure DevOps (Visual Studio Team Services)
- Azure portal (プレビュー)
- Box
- Concur
- CornerStone on Demand
- DocuSign
- Dropbox
- Dynamics 365 CRM (プレビュー)
- Egnyte
- Exchange Online
- G Suite
- GitHub
- HighQ
- JIRA/Confluence
- OneDrive for Business
- LinkedIn Learning
- Power BI
- Salesforce
- ServiceNow
- SharePoint Online
- Slack
- Tableau
- Microsoft Teams (プレビュー)
- Workday
- Workiva
- Workplace by Facebook
- Yammer (プレビュー)

### <a name="a-ido365-apps-office-365-featured-apps"></a>Office 365 のおすすめアプリの <a id="O365-apps" />

Office 365 Cloud App Security でサポートされているおすすめアプリの一覧を次に示します。

- Exchange Online
- OneDrive for Business
- Power BI
- SharePoint Online
- Microsoft Teams (プレビュー)
- Yammer (プレビュー)

おすすめのアプリに関心がある場合は、[アプリに関する詳細情報をお送り](mailto:casfeedback@microsoft.com)ください。 ご希望のユースケースは、お客様のオンボードに送信してください。

## <a name="next-steps"></a>次のステップ:

> [!div class="nextstepaction"]
> [おすすめアプリ用にアプリの条件付きアクセス制御をデプロイする](proxy-deployment-aad.md)

> [!div class="nextstepaction"]
> [アプリの条件付きアクセス制御がすべてのアプリに展開](proxy-deployment-any-app.md)

[!INCLUDE [Open support ticket](includes/support.md)]
